<!--pages/order-detail/order-detail.wxml-->
<view class="order-detail-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <!-- ç©ºç™½å¯¼èˆªæ ï¼Œä¿æŒå“ç‰Œè‰²èƒŒæ™¯ -->
  </view>

  <!-- è®¢å•æ ‡é¢˜åŒºåŸŸ -->
  <view class="order-detail-header">
    <view class="order-detail-back-btn" bindtap="onBackTap">
      <image src="/images/back-arrow-gray.svg" class="back-arrow-icon" />
    </view>
    <view class="order-detail-title-section">
      <text class="order-detail-title">è®¢å•è¯¦æƒ…</text>
    </view>
    <view class="order-detail-placeholder"></view>
  </view>

  <!-- é¡µé¢å†…å®¹ -->
  <view class="order-detail-content">
    <!-- è®¢å•çŠ¶æ€ -->
    <view class="status-section">
      <view class="status-icon">
        <text wx:if="{{orderInfo.status === 'pending'}}">ğŸ’³</text>
        <text wx:elif="{{orderInfo.status === 'paid'}}">ğŸ“¦</text>
        <text wx:elif="{{orderInfo.status === 'shipped'}}">ğŸšš</text>
        <text wx:elif="{{orderInfo.status === 'completed'}}">âœ…</text>
        <text wx:else>âŒ</text>
      </view>
      <view class="status-info">
        <view class="status-text">{{orderInfo.statusText}}</view>
        <view class="status-desc">
          <text wx:if="{{orderInfo.status === 'pending'}}">è¯·å°½å¿«å®Œæˆæ”¯ä»˜ï¼Œè¶…æ—¶è®¢å•å°†è‡ªåŠ¨å–æ¶ˆ</text>
          <text wx:elif="{{orderInfo.status === 'paid'}}">æ‚¨çš„è®¢å•å·²ä»˜æ¬¾ï¼Œæ­£åœ¨å‡†å¤‡å‘è´§</text>
          <text wx:elif="{{orderInfo.status === 'shipped'}}">æ‚¨çš„åŒ…è£¹æ­£åœ¨è·¯ä¸Šï¼Œè¯·è€å¿ƒç­‰å¾…</text>
          <text wx:elif="{{orderInfo.status === 'completed'}}">è®¢å•å·²å®Œæˆï¼Œæ„Ÿè°¢æ‚¨çš„è´­ä¹°</text>
          <text wx:else>{{orderInfo.statusDesc}}</text>
        </view>
        <view class="status-time">{{orderInfo.createTime}}</view>
      </view>
    </view>

    <!-- ç‰©æµä¿¡æ¯ -->
    <view wx:if="{{orderInfo.status === 'shipped' || orderInfo.status === 'completed'}}" class="logistics-section">
      <view class="section-header">
        <view class="section-icon">ğŸ“¦</view>
        <view class="section-title">ç‰©æµä¿¡æ¯</view>
      </view>
      
      <view class="logistics-info">
        <view class="logistics-item">
          <view class="logistics-time">2024-12-25 14:30</view>
          <view class="logistics-desc">åŒ…è£¹å·²åˆ°è¾¾ç›®çš„åœ°ï¼Œå‡†å¤‡æ´¾é€</view>
        </view>
        <view class="logistics-item">
          <view class="logistics-time">2024-12-25 08:20</view>
          <view class="logistics-desc">åŒ…è£¹æ­£åœ¨è¿è¾“é€”ä¸­</view>
        </view>
        <view class="logistics-item">
          <view class="logistics-time">2024-12-24 16:45</view>
          <view class="logistics-desc">åŒ…è£¹å·²ä»å‘è´§åœ°å‘å‡º</view>
        </view>
        <view class="logistics-item">
          <view class="logistics-time">2024-12-24 10:30</view>
          <view class="logistics-desc">å•†å®¶å·²å‘è´§</view>
        </view>
      </view>
      
      <view class="express-info">
        <text class="express-company">{{orderInfo.shippingCompany}}</text>
        <text class="express-number">{{orderInfo.trackingNumber || 'YT2024122500001'}}</text>
      </view>
    </view>

    <!-- æ”¶è´§åœ°å€ -->
    <view class="address-section">
      <view class="section-header">
        <view class="section-icon">ğŸ“</view>
        <view class="section-title">æ”¶è´§åœ°å€</view>
      </view>
      
      <view class="address-info">
        <view class="address-name">{{orderInfo.address.name}} {{orderInfo.address.phone}}</view>
        <view class="address-detail">{{orderInfo.address.detail}}</view>
      </view>
    </view>

    <!-- å•†å“ä¿¡æ¯ -->
    <view class="goods-section">
      <view class="section-header">
        <view class="section-icon">ğŸ›ï¸</view>
        <view class="section-title">å•†å“ä¿¡æ¯</view>
      </view>
      
      <view class="goods-list">
        <view class="goods-item" wx:for="{{orderInfo.goods}}" wx:key="id">
          <view class="goods-info">
            <view class="goods-name">{{item.name}}</view>
            <view class="goods-tags">
              <text class="tag">{{item.age}}</text>
              <text class="tag">{{item.condition}}</text>
              <text class="tag">{{item.count}}æœ¬è£…</text>
            </view>
            <view class="goods-desc">å¹³å‡æ¯æœ¬ Â¥{{item.averagePrice}}</view>
          </view>
          <view class="goods-price">
            <view class="price">Â¥{{item.price}}</view>
            <view class="quantity">x{{item.quantity}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- è®¢å•ä¿¡æ¯ -->
    <view class="order-info-section">
      <view class="section-header">
        <view class="section-icon">ğŸ“„</view>
        <view class="section-title">è®¢å•ä¿¡æ¯</view>
      </view>
      
      <view class="order-info-list">
        <view class="info-item">
          <text class="info-label">è®¢å•ç¼–å·</text>
          <text class="info-value">{{orderInfo.orderNo}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">ä¸‹å•æ—¶é—´</text>
          <text class="info-value">{{orderInfo.createTime}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">æ”¯ä»˜æ–¹å¼</text>
          <text class="info-value">å¾®ä¿¡æ”¯ä»˜</text>
        </view>
        <view class="info-item">
          <text class="info-label">é…é€æ–¹å¼</text>
          <text class="info-value">{{orderInfo.deliveryType === 'express' ? 'å¿«é€’é…é€' : 'é—¨åº—è‡ªå–'}}</text>
        </view>
      </view>
    </view>

    <!-- è´¹ç”¨æ˜ç»† -->
    <view class="amount-section">
      <view class="section-header">
        <view class="section-icon">ğŸ’°</view>
        <view class="section-title">è´¹ç”¨æ˜ç»†</view>
      </view>
      
      <view class="amount-list">
        <view class="amount-item">
          <text class="amount-label">å•†å“é‡‘é¢</text>
          <text class="amount-value">Â¥{{orderInfo.goodsAmount}}</text>
        </view>
        <view class="amount-item">
          <text class="amount-label">è¿è´¹</text>
          <text class="amount-value">{{orderInfo.deliveryFee === 0 ? 'åŒ…é‚®' : 'Â¥' + orderInfo.deliveryFee}}</text>
        </view>
        <view class="amount-item">
          <text class="amount-label">ä¼˜æƒ é‡‘é¢</text>
          <text class="amount-value discount">-Â¥{{orderInfo.discountAmount}}</text>
        </view>
        <view class="amount-item total">
          <text class="amount-label">å®ä»˜é‡‘é¢</text>
          <text class="amount-value">Â¥{{orderInfo.totalAmount}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <view class="action-btn secondary" bindtap="onContactService">
      è”ç³»å®¢æœ
    </view>
    <view 
      wx:if="{{orderInfo.status === 'completed'}}"
      class="action-btn primary" 
      bindtap="onBuyAgain"
    >
      å†æ¬¡è´­ä¹°
    </view>
    <view 
      wx:elif="{{orderInfo.status === 'shipping'}}"
      class="action-btn primary" 
      bindtap="onConfirmReceive"
    >
      ç¡®è®¤æ”¶è´§
    </view>
    <view 
      wx:elif="{{orderInfo.status === 'pending'}}"
      class="action-btn primary" 
      bindtap="onContinuePay"
    >
      ç»§ç»­æ”¯ä»˜
    </view>
    <view 
      wx:elif="{{orderInfo.status === 'pending' || orderInfo.status === 'paid'}}"
      class="action-btn danger" 
      bindtap="onCancelOrder"
    >
      å–æ¶ˆè®¢å•
    </view>
  </view>
</view> 