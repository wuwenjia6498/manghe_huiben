<!--pages/product-detail/product-detail.wxml-->
<view class="product-detail-container">
  <!-- 自定义导航栏 -->
  <view class="custom-navbar">
    <view class="navbar-center">
      <text class="navbar-title">商品详情</text>
    </view>
    <view class="navbar-right" bindtap="onShareTap">
      <view class="share-icon">⤴</view>
    </view>
  </view>

  <!-- 商品主图区域 -->
  <view class="product-hero">
    <!-- 背景图片 -->
    <image src="/images/product-detail-banner.jpg" class="hero-bg-image" mode="aspectFill" />
    
    <view class="hero-overlay">
      <view class="hero-content">
        <view class="brand-info">
          <view class="brand-icon">📚</view>
          <text class="brand-name">{{productInfo.name}}</text>
        </view>
        <view class="product-subtitle">{{productInfo.subtitle}}</view>
      </view>
    </view>
  </view>

  <!-- 价格显示 -->
  <view class="price-section">
    <view class="current-price" wx:if="{{currentPrice > 0}}">¥{{currentPrice}}</view>
    <view class="current-price placeholder" wx:else>请选择配置</view>
    <view class="original-price" wx:if="{{originalPrice > 0}}">¥{{originalPrice}}</view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-mask" wx:if="{{priceLoading}}">
    <view class="loading-text">加载中...</view>
  </view>

  <!-- 商品选项 -->
  <view class="options-container">
    <!-- 年龄段选择 -->
    <view class="option-card">
      <view class="option-title-row">
        <text class="option-emoji">🧒</text>
        <text class="option-name">选择年龄段</text>
      </view>
      <view class="option-subtitle">为您的孩子选择合适的年龄段</view>
      <view class="option-buttons">
        <view 
          wx:for="{{availableOptions.ageRanges}}" 
          wx:key="*this"
          class="option-btn {{selectedAgeRange === item ? 'active' : ''}}"
          data-age="{{item}}"
          bindtap="onAgeRangeSelect"
        >
          {{item}}岁
        </view>
      </view>
    </view>

    <!-- 成色选择 -->
    <view class="option-card">
      <view class="option-title-row">
        <text class="option-emoji">⭐</text>
        <text class="option-name">选择新旧程度</text>
      </view>
      <view class="option-subtitle">不同品相，不同价格</view>
      <view class="option-buttons">
        <view 
          wx:for="{{availableConditions}}" 
          wx:key="*this"
          class="option-btn {{selectedCondition === item ? 'active' : ''}} {{!selectedAgeRange ? 'disabled' : ''}}"
          data-condition="{{item}}"
          bindtap="{{selectedAgeRange ? 'onConditionSelect' : ''}}"
        >
          {{item}}
        </view>
      </view>
    </view>

    <!-- 本数选择 -->
    <view class="option-card">
      <view class="option-title-row">
        <text class="option-emoji">🗂️</text>
        <text class="option-name">选择本数</text>
      </view>
      <view class="option-subtitle">更多本数更超值，平均单本价格更低</view>
      <view class="option-buttons">
        <view 
          wx:for="{{availableQuantities}}" 
          wx:key="*this"
          class="option-btn {{selectedQuantity === item ? 'active' : ''}} {{!selectedAgeRange || !selectedCondition ? 'disabled' : ''}}"
          data-quantity="{{item}}"
          bindtap="{{selectedAgeRange && selectedCondition ? 'onQuantitySelect' : ''}}"
        >
          {{item}}
        </view>
      </view>
    </view>
  </view>

  <!-- 成新度说明 -->
  <view class="info-section">
    <view class="info-header">
      <view class="info-icon">💡</view>
      <text class="info-title">成新度说明</text>
    </view>
    <view class="info-list">
      <view class="info-item" wx:for="{{conditionInfo}}" wx:key="condition">
        <text class="condition-name">{{item.condition}}：</text>
        <text class="condition-desc">{{item.description}}</text>
      </view>
    </view>
  </view>

  <!-- 发货与售后 -->
  <view class="info-section">
    <view class="info-header">
      <view class="info-icon">🚚</view>
      <text class="info-title">发货与售后</text>
    </view>
    <view class="service-list">
      <view class="service-item">
        <view class="service-icon good">📦</view>
        <text class="service-text">随机发货，盲盒内容为惊喜组合</text>
      </view>
      <view class="service-item">
        <view class="service-icon">⏰</view>
        <text class="service-text">{{shippingTime}}</text>
      </view>
      <view class="service-item">
        <view class="service-icon error">❌</view>
        <text class="service-text">盲盒商品不支持退换货</text>
      </view>
      <view class="service-item">
        <view class="service-icon info">💬</view>
        <text class="service-text">如有质量问题，请联系客服处理</text>
      </view>
    </view>
  </view>

  <!-- 底部操作栏 -->
  <view class="bottom-actions">
    <view class="action-btn secondary" bindtap="onAddToCart">
      加入购物车
    </view>
    <view class="action-btn primary" bindtap="onBuyNow">
      立即购买
    </view>
  </view>
</view>