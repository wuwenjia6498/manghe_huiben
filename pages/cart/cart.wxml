<!--pages/cart/cart.wxml-->
<view class="cart-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <!-- ç©ºç™½å¯¼èˆªæ ï¼Œä¿æŒå“ç‰Œè‰²èƒŒæ™¯ -->
  </view>

  <!-- è´­ç‰©è½¦æ ‡é¢˜åŒºåŸŸ -->
  <view class="cart-header">
    <view class="cart-title-section">
      <view class="cart-icon">ğŸ›’</view>
      <view class="cart-title-text">
        <text class="cart-title">è´­ç‰©è½¦</text>
      </view>
    </view>
    <view class="cart-actions">
      <view class="action-btn" bindtap="onDeleteModeTap">
        <view class="action-icon">ğŸ—‘</view>
        <text class="action-text">ç®¡ç†</text>
      </view>
    </view>
  </view>

  <!-- è´­ç‰©è½¦å•†å“åˆ—è¡¨ -->
  <view class="cart-content">
    <view wx:if="{{cartList.length > 0}}" class="cart-list">
      <view 
        class="cart-item" 
        wx:for="{{cartList}}" 
        wx:key="id"
      >
        <!-- é€‰æ‹©æ¡† -->
        <view class="item-checkbox" bindtap="onSelectItem" data-index="{{index}}">
          <view class="checkbox {{item.selected ? 'checked' : ''}}">
            <view wx:if="{{item.selected}}" class="check-icon">âœ“</view>
          </view>
        </view>

        <!-- å•†å“å›¾ç‰‡ -->
        <view class="item-image">
          <image src="{{item.coverUrl}}" class="product-image" mode="aspectFill" />
        </view>

        <!-- å•†å“ä¿¡æ¯ -->
        <view class="item-info">
          <view class="product-title">{{item.name}}</view>
          <view class="product-tags">
            <text class="tag">{{item.age}}</text>
            <text class="tag">{{item.condition}}</text>
            <text class="tag">{{item.count}}æœ¬è£…</text>
          </view>
          <view class="product-desc">å¹³å‡æ¯æœ¬ Â¥{{item.averagePrice}} Â· {{item.description}}</view>
          
          <!-- ä»·æ ¼å’Œæ§åˆ¶åŒºåŸŸ -->
          <view class="item-bottom">
            <view class="item-price">Â¥{{item.price}}</view>
            <view class="quantity-controls">
              <view 
                class="control-btn {{item.quantity <= 1 ? 'disabled' : ''}}" 
                bindtap="onDecreaseQuantity" 
                data-index="{{index}}"
              >
                âˆ’
              </view>
              <view class="quantity-num">{{item.quantity}}</view>
              <view 
                class="control-btn" 
                bindtap="onIncreaseQuantity" 
                data-index="{{index}}"
              >
                +
              </view>
            </view>
            <view class="delete-btn" bindtap="onDeleteItem" data-index="{{index}}">
              åˆ é™¤
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºè´­ç‰©è½¦çŠ¶æ€ -->
    <view wx:else class="empty-cart">
      <view class="empty-icon">ğŸ“š</view>
      <view class="empty-text">è´­ç‰©è½¦è¿˜æ˜¯ç©ºçš„</view>
      <view class="empty-desc">å¿«å»æ·»åŠ ä¸€äº›ç»˜æœ¬ç›²ç›’å§ï½</view>
      <view class="empty-actions">
        <view class="goto-home-btn" bindtap="onGoToHome">
          å»é¦–é¡µçœ‹çœ‹
        </view>
        <view class="goto-blindbox-btn" bindtap="onGoToBlindbox">
          é€‰æ‹©ç›²ç›’
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨ç»“ç®—æ  -->
  <view wx:if="{{cartList.length > 0}}" class="bottom-bar">
    <view class="select-all" bindtap="onSelectAll">
      <view class="checkbox {{isAllSelected ? 'checked' : ''}}">
        <view wx:if="{{isAllSelected}}" class="check-icon">âœ“</view>
      </view>
      <text class="select-all-text">å…¨é€‰</text>
    </view>
    
    <view class="checkout-info">
      <view class="selected-info">
        å·²é€‰ <text class="highlight">{{selectedCount}}</text> ä»¶å•†å“
      </view>
      <view class="total-section">
        <text class="total-label">åˆè®¡:</text>
        <text class="total-price">Â¥{{totalPrice}}</text>
      </view>
    </view>
    
    <view 
      class="checkout-btn {{selectedCount > 0 ? 'active' : 'disabled'}}" 
      bindtap="onCheckout"
    >
      å»ç»“ç®—
    </view>
  </view>
</view>