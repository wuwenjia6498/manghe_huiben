<!--pages/orders/orders.wxml-->
<view class="orders-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <!-- ç©ºç™½å¯¼èˆªæ ï¼Œä¿æŒå“ç‰Œè‰²èƒŒæ™¯ -->
  </view>

  <!-- è®¢å•æ ‡é¢˜åŒºåŸŸ -->
  <view class="orders-header">
    <view class="orders-back-btn" bindtap="onBackTap">
      <image src="/images/back-arrow-gray.svg" class="back-arrow-icon" />
    </view>
    <view class="orders-title-section">
      <text class="orders-title">æˆ‘çš„è®¢å•</text>
    </view>
    <view class="orders-placeholder"></view>
  </view>

  <!-- è®¢å•çŠ¶æ€ç­›é€‰ -->
  <view class="status-tabs">
    <view 
      class="tab-item {{currentTab === 'all' ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="all"
    >
      <text>å…¨éƒ¨</text>
      <text class="tab-count" wx:if="{{orderCounts.all > 0}}">({{orderCounts.all}})</text>
    </view>
    <view 
      class="tab-item {{currentTab === 'pending' ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="pending"
    >
      <text>å¾…æ”¯ä»˜</text>
      <text class="tab-count" wx:if="{{orderCounts.pending > 0}}">({{orderCounts.pending}})</text>
    </view>
    <view 
      class="tab-item {{currentTab === 'paid' ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="paid"
    >
      <text>å¾…å‘è´§</text>
      <text class="tab-count" wx:if="{{orderCounts.paid > 0}}">({{orderCounts.paid}})</text>
    </view>
    <view 
      class="tab-item {{currentTab === 'shipped' ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="shipped"
    >
      <text>å¾…æ”¶è´§</text>
      <text class="tab-count" wx:if="{{orderCounts.shipped > 0}}">({{orderCounts.shipped}})</text>
    </view>
    <view 
      class="tab-item {{currentTab === 'completed' ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="completed"
    >
      <text>å·²å®Œæˆ</text>
      <text class="tab-count" wx:if="{{orderCounts.completed > 0}}">({{orderCounts.completed}})</text>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="orders-content">
    <view wx:if="{{orderList.length > 0}}" class="orders-list">
      <view class="order-item" wx:for="{{orderList}}" wx:key="id">
        <!-- è®¢å•å¤´éƒ¨ -->
        <view class="order-header">
          <view class="order-info">
            <view class="order-number-row">
              <text class="order-icon">ğŸ“¦</text>
              <text class="order-number">è®¢å•å·ï¼š{{item.orderNo}}</text>
            </view>
            <text class="order-time">{{item.createTime}}</text>
          </view>
          <view class="order-status {{item.status}}">{{item.statusText}}</view>
        </view>

        <!-- å•†å“åˆ—è¡¨ -->
        <view class="goods-list">
          <view class="goods-item" wx:for="{{item.goods}}" wx:key="id" wx:for-item="goods">
            <view class="goods-info">
              <view class="goods-name">{{goods.name}}</view>
              <view class="goods-tags">
                <text class="tag">{{goods.age}}</text>
                <text class="tag">{{goods.condition}}</text>
                <text class="tag">{{goods.count}}æœ¬è£…</text>
              </view>
              <view class="goods-desc">å¹³å‡æ¯æœ¬ Â¥{{goods.averagePrice}}</view>
            </view>
            <view class="goods-price">
              <view class="price">Â¥{{goods.price}}</view>
              <view class="quantity">x{{goods.quantity}}</view>
            </view>
          </view>
        </view>

        <!-- è®¢å•é‡‘é¢ -->
        <view class="order-amount">
          <text class="amount-label">å®ä»˜æ¬¾ï¼š</text>
          <text class="amount-value">Â¥{{item.totalAmount}}</text>
        </view>

        <!-- è®¢å•æ“ä½œ -->
        <view class="order-actions">
          <view class="action-btn secondary" bindtap="onOrderDetail" data-order="{{item}}">
            æŸ¥çœ‹è¯¦æƒ…
          </view>
          <view 
            wx:if="{{item.status === 'completed'}}"
            class="action-btn primary" 
            bindtap="onBuyAgain" 
            data-order="{{item}}"
          >
            å†æ¬¡è´­ä¹°
          </view>
          <view 
            wx:elif="{{item.status === 'shipped'}}"
            class="action-btn primary" 
            bindtap="onConfirmReceive" 
            data-order="{{item}}"
          >
            ç¡®è®¤æ”¶è´§
          </view>
          <view 
            wx:elif="{{item.status === 'pending'}}"
            class="action-btn primary" 
            bindtap="onContinuePay" 
            data-order="{{item}}"
          >
            ç»§ç»­æ”¯ä»˜
          </view>
          <view 
            wx:elif="{{item.status === 'pending'}}"
            class="action-btn secondary" 
            bindtap="onCancelOrder" 
            data-order="{{item}}"
          >
            å–æ¶ˆè®¢å•
          </view>
          <view 
            wx:elif="{{item.status === 'paid'}}"
            class="action-btn secondary" 
            bindtap="onCancelOrder" 
            data-order="{{item}}"
          >
            å–æ¶ˆè®¢å•
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-orders">
      <view class="empty-icon">ğŸ“¦</view>
      <view class="empty-text">æš‚æ— ç›¸å…³è®¢å•</view>
      <view class="empty-desc">å¿«å»é€‰è´­ä¸€äº›ç»˜æœ¬ç›²ç›’å§ï½</view>
      <view class="goto-home-btn" bindtap="onGoToHome">
        å»é¦–é¡µçœ‹çœ‹
      </view>
    </view>
  </view>
</view> 