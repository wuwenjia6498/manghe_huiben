<!--pages/admin-users/admin-users.wxml-->
<view class="admin-users-page">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-title">
    ç”¨æˆ·ç®¡ç†
    <view class="title-actions">
      <view class="search-icon" bindtap="onToggleSearch">
        {{showSearch ? 'âœ•' : 'ğŸ”'}}
      </view>
      <view class="export-icon" bindtap="onExportUsers">
        ğŸ“¤
      </view>
    </view>
  </view>

  <!-- æœç´¢æ¡† -->
  <view class="search-container" wx:if="{{showSearch}}">
    <view class="search-box">
      <input class="search-input" 
             placeholder="æœç´¢ç”¨æˆ·æ˜µç§°ã€æ‰‹æœºå·" 
             value="{{searchKeyword}}" 
             bindinput="onSearchInput"
             bindconfirm="onSearchConfirm" />
      <view class="search-clear" wx:if="{{searchKeyword}}" bindtap="onClearSearch">âœ•</view>
    </view>
    <view class="search-cancel" bindtap="onCancelSearch">å–æ¶ˆ</view>
  </view>

  <!-- ç”¨æˆ·çŠ¶æ€ç­›é€‰ -->
  <view class="status-filter">
    <view class="status-item {{currentFilter === 'all' ? 'active' : ''}}" 
          data-filter="all" bindtap="onFilterChange">
      <text class="status-text">å…¨éƒ¨ç”¨æˆ·</text>
    </view>
    <view class="status-item {{currentFilter === 'vip' ? 'active' : ''}}" 
          data-filter="vip" bindtap="onFilterChange">
      <text class="status-text">VIPç”¨æˆ·</text>
    </view>
    <view class="status-item {{currentFilter === 'normal' ? 'active' : ''}}" 
          data-filter="normal" bindtap="onFilterChange">
      <text class="status-text">æ™®é€šç”¨æˆ·</text>
    </view>
    <view class="status-item {{currentFilter === 'blocked' ? 'active' : ''}}" 
          data-filter="blocked" bindtap="onFilterChange">
      <text class="status-text">å·²å°ç¦</text>
    </view>
  </view>

  <!-- ç”¨æˆ·åˆ—è¡¨ -->
  <view class="users-list">
    <view class="user-card" wx:for="{{users}}" wx:key="id">
      <view class="user-content">
        <!-- ç”¨æˆ·å¤´éƒ¨ä¿¡æ¯ -->
        <view class="user-header">
          <view class="user-info">
            <view class="user-avatar">
              <image wx:if="{{item.avatar}}" src="{{item.avatar}}" class="avatar-img" />
              <text wx:else class="default-avatar-text">ğŸ‘¤</text>
            </view>
            <view class="user-basic">
              <view class="user-name">{{item.nickname || 'æœªè®¾ç½®æ˜µç§°'}}</view>
              <view class="user-phone">{{item.phone || 'æœªç»‘å®šæ‰‹æœº'}}</view>
            </view>
          </view>
          <view class="user-status {{item.status}}">
            <text class="status-text">{{item.statusText}}</text>
            <view class="edit-btn" bindtap="onEditUserStatus" data-user="{{item}}">
              ä¿®æ”¹
            </view>
          </view>
        </view>

        <!-- ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ -->
        <view class="user-details">
          <view class="detail-row">
            <text class="label">æ³¨å†Œæ—¶é—´ï¼š</text>
            <text class="value">{{item.registerTime}}</text>
          </view>
          <view class="detail-row">
            <text class="label">æœ€åæ´»è·ƒï¼š</text>
            <text class="value {{item.activityClass}}">{{item.lastLoginTime}} {{item.activityIndicator}}</text>
          </view>
          <view class="detail-row">
            <text class="label">æ´»è·ƒåº¦ï¼š</text>
            <text class="value">{{item.activityText}}</text>
          </view>
          <view class="detail-row">
            <text class="label">è®¢å•æ•°é‡ï¼š</text>
            <text class="value highlight">{{item.orderCount}}å•</text>
          </view>
          <view class="detail-row">
            <text class="label">æ¶ˆè´¹é‡‘é¢ï¼š</text>
            <text class="value highlight">Â¥{{item.totalAmount}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{users.length === 0 && !loading}}">
      <view class="empty-icon">ğŸ‘¥</view>
      <view class="empty-text">æš‚æ— ç”¨æˆ·æ•°æ®</view>
      <view class="empty-desc">{{searchKeyword ? 'æœªæ‰¾åˆ°ç›¸å…³ç”¨æˆ·' : 'ç³»ç»Ÿä¸­è¿˜æ²¡æœ‰ç”¨æˆ·'}}</view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-icon">â³</view>
      <view class="loading-text">æ­£åœ¨åŠ è½½ç”¨æˆ·æ•°æ®...</view>
    </view>
  </view>

  <!-- ç®¡ç†ç«¯åº•éƒ¨å¯¼èˆª -->
  <view class="admin-tabbar">
    <view class="tab-item {{currentTab === 'home' ? 'active' : ''}}" bindtap="onTabSwitch" data-tab="home">
      <view class="tab-icon">ğŸ </view>
      <view class="tab-text">é¦–é¡µ</view>
    </view>
    <view class="tab-item {{currentTab === 'products' ? 'active' : ''}}" bindtap="onTabSwitch" data-tab="products">
      <view class="tab-icon">ğŸ“¦</view>
      <view class="tab-text">å•†å“</view>
    </view>
    <view class="tab-item {{currentTab === 'orders' ? 'active' : ''}}" bindtap="onTabSwitch" data-tab="orders">
      <view class="tab-icon">ğŸ“‹</view>
      <view class="tab-text">è®¢å•</view>
    </view>
    <view class="tab-item {{currentTab === 'users' ? 'active' : ''}}" bindtap="onTabSwitch" data-tab="users">
      <view class="tab-icon">ğŸ‘¥</view>
      <view class="tab-text">ç”¨æˆ·</view>
    </view>
    <view class="tab-item {{currentTab === 'settings' ? 'active' : ''}}" bindtap="onTabSwitch" data-tab="settings">
      <view class="tab-icon">âš™ï¸</view>
      <view class="tab-text">è®¾ç½®</view>
    </view>
  </view>
</view>