# "我的"页面待支付卡片功能说明

## 功能概述

在"我的"页面的订单管理区块新增"待支付"卡片，方便用户快速访问待支付订单。

## 修改内容

### 1. 订单管理区块新增待支付卡片

**文件：** `pages/profile/profile.wxml`

在订单管理区块的第一个位置添加待支付卡片：

```xml
<view class="menu-item" bindtap="onOrdersTap" data-type="pending">
  <view class="item-icon unpaid">💳</view>
  <view class="item-info">
    <view class="item-title">
      <text>待支付</text>
      <text class="order-count" wx:if="{{orderCounts.pending > 0}}">({{orderCounts.pending}})</text>
    </view>
    <view class="item-desc">查看待支付订单</view>
  </view>
  <view class="item-arrow">></view>
</view>
```

### 2. 数据结构更新

**文件：** `pages/profile/profile.js`

在 orderCounts 数据中添加 pending 字段：

```javascript
orderCounts: {
  all: 0,
  pending: 0,  // ✅ 新增：待支付
  paid: 0,     // 待发货
  shipped: 0   // 待收货
}
```

### 3. 样式添加

**文件：** `pages/profile/profile.wxss`

为待支付卡片添加红色渐变样式：

```css
.item-icon.unpaid {
  background: linear-gradient(135deg, #FF6B6B 0%, #EE5A52 100%);
}
```

## 卡片顺序

现在订单管理区块的卡片顺序为：

1. **待支付** 💳（红色） - 点击跳转到待支付列表
2. **待发货** 📦（绿色） - 点击跳转到待发货列表
3. **待收货** 🚚（蓝色） - 点击跳转到待收货列表
4. **全部订单** 📋（紫色） - 点击跳转到全部订单列表

## 界面展示

```
┌────────────────────────────────┐
│  订单管理                       │
├────────────────────────────────┤
│ 💳 待支付 (2)                   │
│    查看待支付订单               │
├────────────────────────────────┤
│ 📦 待发货 (1)                   │
│    查看待发货订单               │
├────────────────────────────────┤
│ 🚚 待收货 (0)                   │
│    查看运输中订单               │
├────────────────────────────────┤
│ 📋 全部订单 (5)                 │
│    查看所有订单                 │
└────────────────────────────────┘
```

## 功能特性

### 1. 订单数量角标
- 当有待支付订单时，显示数量角标 `(n)`
- 数量为 0 时不显示角标

### 2. 点击跳转
- 点击卡片跳转到订单列表页面
- 自动切换到"待支付"标签页

### 3. 实时更新
- 订单数量统计实时更新
- 每次进入"我的"页面自动刷新

## 颜色设计

| 卡片类型 | 图标 | 颜色 | 用途 |
|---------|------|------|------|
| 待支付 | 💳 | 红色（#FF6B6B → #EE5A52） | 提醒用户完成支付 |
| 待发货 | 📦 | 绿色（#4CAF50 → #45A049） | 表示已支付等待发货 |
| 待收货 | 🚚 | 蓝色（#2196F3 → #1976D2） | 表示运输中 |
| 全部订单 | 📋 | 紫色（#9C27B0 → #7B1FA2） | 通用列表 |

## 用户体验流程

### 场景1：有待支付订单

1. 用户打开"我的"页面
2. 看到"待支付"卡片显示 `(2)` 角标
3. 点击卡片
4. 跳转到订单列表页面，自动选中"待支付"标签
5. 看到2个待支付订单，可以继续支付或取消

### 场景2：无待支付订单

1. 用户打开"我的"页面
2. "待支付"卡片不显示数量角标
3. 点击卡片
4. 跳转到订单列表页面，显示"暂无订单"提示

## 数据来源

订单数量统计来自云函数 `order.getOrderStats`：

```javascript
{
  all: 5,       // 全部订单（不含已取消）
  pending: 2,   // 待支付订单
  paid: 1,      // 待发货订单
  shipped: 0,   // 待收货订单
  completed: 2  // 已完成订单
}
```

## 修改文件清单

- ✅ `pages/profile/profile.wxml` - 添加待支付卡片
- ✅ `pages/profile/profile.js` - 更新数据结构
- ✅ `pages/profile/profile.wxss` - 添加样式

## 测试验证

### 测试步骤

1. **创建待支付订单**
   - 添加商品到购物车
   - 点击"去结算"
   - 点击"确认支付"
   - 取消支付

2. **验证卡片显示**
   - 打开"我的"页面
   - ✅ 验证："待支付"卡片显示 `(1)` 角标

3. **验证跳转**
   - 点击"待支付"卡片
   - ✅ 验证：跳转到订单列表页面
   - ✅ 验证：自动选中"待支付"标签
   - ✅ 验证：看到刚才创建的订单

4. **验证数量更新**
   - 完成支付或取消订单
   - 返回"我的"页面
   - ✅ 验证：待支付数量更新

## 相关文档

- [订单状态管理修复说明.md](./订单状态管理修复说明.md)
- [待支付状态功能说明.md](./待支付状态功能说明.md)
- [订单列表筛选逻辑修复说明.md](./订单列表筛选逻辑修复说明.md)

## 版本信息

- **完成日期：** 2025-10-19
- **开发人员：** AI Assistant
- **功能类型：** 用户体验优化
- **影响范围：** "我的"页面订单管理区块

---

## 总结

通过在"我的"页面增加"待支付"卡片，用户可以更方便地找到和管理未支付的订单，提升了用户体验和订单完成率。

**核心改进：**
- ✅ 新增待支付快捷入口
- ✅ 直观的数量角标提醒
- ✅ 醒目的红色渐变设计
- ✅ 一键跳转到待支付列表

